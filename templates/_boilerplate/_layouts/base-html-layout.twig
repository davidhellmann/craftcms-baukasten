{# Base HTML layout template that all HTML requests inherit from #}
{% extends craft.app.request.isAjax() and not craft.app.request.getIsPreview()
  ? "_boilerplate/_layouts/base-ajax-layout.twig"
  : "_boilerplate/_layouts/base-web-layout.twig" %}

{% block htmlTag %}
{# Add some body classes #}
{% set sectionHandle = entry.section.handle ??? null %}
{% set pageClassSection = sectionHandle ? 'p-' ~ sectionHandle : '' %}
{% set pageClassEntryType = sectionHandle ? 'p-' ~ sectionHandle ??? null ~ '--' ~ entry.type.handle : '' %}
<html
  class="no-js {{ pageClassSection }} {{ pageClassEntryType }} {{ appClass ??? null }} {{ craft.app.config.general.devMode ? 't-devMode' : '' }}"
  lang="{{ craft.app.language |slice(0,2) }}"
  prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb#">
{% endblock htmlTag %}

{# Page content that should be included in the <head> #}
{% block headContent %}
  {# Any <meta> tags that should be included in the <head> #}
  {% block headMeta %}
  {% endblock headMeta %}

  {# Any <link> tags that should be included in the <head> #}
  {% block headLinks %}
  {% endblock headLinks %}

  {# Inline and polyfill JS #}
  {% include "_boilerplate/_partials/head-js.twig" %}

  {# Any JavaScript that should be included before </head> #}
  {% block headJs %}
  {% endblock headJs %}

  {# Webfonts #}
  {% include "_partials/font-face-observer.twig" %}

  {# Lovely GDPR #}
  {% include "_partials/gdpr.twig" %}

  {# Inline and critical CSS #}
  <style>
    [v-cloak] > * {
      display: none !important;
    }

    [v-cloak]::before {
      content: "loadingâ€¦"
    }

    {# Any CSS that should be included before </head> #}
    {% block headCss %}
    {% endblock headCss %}
  </style>

  {# Critical CSS #}
  {% include "_boilerplate/_partials/critical-css.twig" %}

{% endblock headContent %}

{# Page content that should be included in the <body> #}
{% block bodyContent %}
  {# Page content that should be included in the <body> #}
  {% block bodyHtml %}
  {% endblock bodyHtml %}

  {#-- Site-wide JavaScript --#}
  {{ craft.twigpack.includeSafariNomoduleFix() }}
  {{ craft.twigpack.includeJsModule("app.js", true) }}

  {# Twigpack/Webpack #}
  {% if craft.app.config.general.custom.craftEnv == 'local' %}
    {{ craft.twigpack.includeJsModule("css.js", true) }}
  {% endif %}

  {# Any JavaScript that should be included before </body> #}
  {% block bodyJs %}
  {% endblock bodyJs %}
{% endblock bodyContent %}
